# 차트 분석 탭 개선사항

## 🐛 문제점

1. **캔들스틱이 안 보임**: 높이 500px로 여러 이동평균선이 표시되면서 차트가 너무 작음
2. **색상 충돌**:
   - MA5가 빨강(상승 캔들과 같음)
   - MA20이 파랑(하락 캔들과 같음)
   - 이로 인해 각 선을 구분하기 어려움
3. **범례 가독성**: 차트 우측에 범례가 겹쳐 있음
4. **선의 두께**: 모든 선의 두께가 동일하여 중요도 구분 어려움

---

## ✅ 개선사항

### 1. 캔들스틱 차트 개선

**높이 증가**
```python
height=700  # 기존: 500 → 개선: 700
```

**캔들스틱 색상 명확화**
```python
# 상승: 밝은 빨강 (#FF3131)
# 하락: 진한 파랑 (#0047AB)
# 테두리도 1px로 지정하여 명확함
```

**캔들스틱 이름 추가**
```python
name='캔들스틱'  # 범례에 표시
```

### 2. 이동평균선 색상 및 두께 개선

| MA선 | 색상 | 이전 | 개선 | 설명 |
|------|------|------|------|------|
| **MA5** | #FFB400 (황색) | width=1 | width=2 | 단기 추세 |
| **MA20** | #FF6B9D (핑크) | width=1 | width=2 | 중기 추세 |
| **MA60** | #00D084 (초록) | width=1 | width=2.5 | 장기 추세 (가장 굵게) |

**Hover 정보 추가**
```python
hovertemplate='<b>%{x|%Y-%m-%d}</b><br>MA5: %{y:.2f}<extra></extra>'
```

### 3. 범례 개선

**위치 변경**
```python
legend=dict(
    orientation='v',  # 수직 배열
    yanchor='top',
    y=0.99,           # 상단
    xanchor='left',
    x=0.01,           # 좌측
    bgcolor='rgba(255,255,255,0.8)',  # 반투명 배경
    bordercolor='#CCCCCC',             # 테두리
    borderwidth=1
)
```

### 4. 글자 크기 통일

```python
font=dict(size=11)  # 모든 차트에 통일
```

### 5. 각 차트 높이 조정

| 차트 | 기존 높이 | 개선 높이 |
|------|----------|----------|
| 가격 차트 | 500 | **700** |
| 거래량 | 300 | **350** |
| MACD | 350 | **380** |
| 변동성 | 350 | **380** |

---

## 📊 차트 구성

```
┌─────────────────────────────────────┐
│  캔들스틱 + MA5/20/60 (높이: 700)   │
│  ┌─ 범례: MA5, MA20, MA60           │
│  └─ 색상 명확함                    │
└─────────────────────────────────────┘

┌─────────────────────────────────────┐
│  거래량 바 차트 (높이: 350)          │
│  상승봉: 초록, 하락봉: 빨강         │
└─────────────────────────────────────┘

┌─────────────────────────────────────┐
│  MACD (높이: 380)                   │
│  MACD선: 파랑, Signal: 빨강         │
│  Histogram: 녹색/빨강 (극성)        │
└─────────────────────────────────────┘

┌─────────────────────────────────────┐
│  변동성 (높이: 380)                 │
│  2%-8% 적정 범위 표시 (초록 점선)   │
└─────────────────────────────────────┘
```

---

## 🎯 사용자 경험 개선

### Before
- 캔들스틱이 작아 보임
- 이동평균선이 캔들스틱과 색상 충돌
- 범례가 차트 우측에 겹침
- 각 지표의 중요도 구분 어려움

### After
- 캔들스틱이 명확히 표시됨
- 이동평균선이 구분 가능한 색상으로 표시
- 범례가 좌상단에서 깔끔하게 표시됨
- MA60이 가장 굵어 장기 추세가 강조됨
- 전체 차트가 더 커져 상세 분석 가능

---

## 🎨 색상 코드 정리

| 요소 | 색상 코드 | 용도 |
|------|----------|------|
| 상승 캔들 | #FF3131 | Candlestick |
| 하락 캔들 | #0047AB | Candlestick |
| MA5 | #FFB400 | 황색 (단기) |
| MA20 | #FF6B9D | 핑크 (중기) |
| MA60 | #00D084 | 초록 (장기) |
| MACD | #0047AB | 파랑 |
| Signal | #FF3131 | 빨강 |
| 적정 범위 | 초록 점선 | 변동성 |

---

## 📝 변경된 파일

- **app.py**: 라인 774-967 (캔들스틱, MA, MACD, 변동성 차트 개선)

### 구체적 라인 수정
- **라인 788-789**: 캔들스틱 색상 지정
- **라인 796-809**: MA 선 색상/두께 개선 + Hover 정보 추가
- **라인 817, 862, 914, 955**: 각 차트 높이 조정
- **라인 820-831, 918-925, 959-966**: 범례 및 글자 크기 개선

---

## ✨ 추가 개선 가능 항목

1. **RSI 차트 추가**: 0-100 범위, 30-70 적정 범위 표시
2. **Bollinger Bands**: 변동성 대역 표시
3. **Support/Resistance 레벨**: 자동 계산 및 표시
4. **Volume 프로필**: 거래량 분포 표시
5. **차트 저장 기능**: PNG/PDF 다운로드

---

**개선 완료 날짜**: 2025-11-14
**버전**: v2.2.0
**상태**: ✅ 완료
